var t=new getApp;Page({data:{currentIndex:"1",proJect:[],orderData:[],page:1,farmSetData:[]},onLoad:function(a){var e=this,r=wx.getStorageSync("kejia_farm_uid"),i=t.siteInfo.uniacid;t.util.request({url:"entry/wxapp/group",data:{op:"getGroupList",uid:r,uniacid:i},success:function(t){e.setData({orderData:t.data.orderData})}}),t.util.setNavColor(i),e.setData({farmSetData:wx.getStorageSync("kejia_farm_setData")})},getOrderData:function(){var a=this,e=wx.getStorageSync("kejia_farm_uid"),r=t.siteInfo.uniacid;t.util.request({url:"entry/wxapp/group",data:{op:"getGroupList",uid:e,uniacid:r},success:function(t){a.setData({orderData:t.data.orderData})}})},changeIndex:function(a){var e=a.currentTarget.dataset.index,r=this;this.setData({currentIndex:a.currentTarget.dataset.index});var r=this,i=wx.getStorageSync("kejia_farm_uid"),n=t.siteInfo.uniacid;t.util.request({url:"entry/wxapp/group",data:{op:"getGroupList",uid:i,uniacid:n,status:e},success:function(t){r.setData({orderData:t.data.orderData})}})},payGroupOrder:function(a){var e=t.siteInfo.uniacid,r=(wx.getStorageSync("kejia_farm_uid"),a.currentTarget.dataset.orderid);t.util.pay(r,"entry/wxapp/groupPay","entry/wxapp/group","orderList/index",e,"notify")},applyRefund:function(a){var e=this,r=t.siteInfo.uniacid,i=wx.getStorageSync("kejia_farm_uid"),n=a.currentTarget.dataset.orderid;t.util.request({url:"entry/wxapp/group",data:{op:"applyGroupRefund",uid:i,uniacid:r,order_id:n},success:function(t){1==t.data.code?(wx.showToast({title:"申请已提交"}),e.getOrderData()):wx.showToast({title:"申请失败"})}})},sureGoods:function(a){var e=this,r=t.siteInfo.uniacid,i=wx.getStorageSync("kejia_farm_uid"),n=a.currentTarget.dataset.orderid;t.util.request({url:"entry/wxapp/group",data:{op:"sureGoods",uid:i,uniacid:r,order_id:n},success:function(t){1==t.data.code?(wx.showToast({title:"收货成功"}),e.getOrderData()):wx.showToast({title:"收货失败"})}})},cancelOrder:function(a){var e=this,r=t.siteInfo.uniacid,i=wx.getStorageSync("kejia_farm_uid"),n=a.currentTarget.dataset.orderid;t.util.request({url:"entry/wxapp/group",data:{op:"cancelOrder",uid:i,uniacid:r,order_id:n},success:function(t){1==t.data.code?(wx.showToast({title:"取消成功"}),e.getOrderData()):wx.showToast({title:"取消失败"})}})},onReachBottom:function(a){var e=this,r=wx.getStorageSync("kejia_farm_uid"),i=t.siteInfo.uniacid,n=e.data.page,d=e.data.orderData,u=e.data.currentIndex;t.util.request({url:"entry/wxapp/group",data:{op:"getGroupList",uid:r,uniacid:i,status:u,page:n},success:function(t){if(console.log(t),t.data.orderData){for(var a=t.data.orderData,r=0;r<a.length;r++)d.push(a[r]);e.setData({orderData:d,page:parseInt(n)+1})}}})},deleteOrder:function(a){var e=this;wx.showModal({title:"提示",content:"确认删除订单吗？删除后将不可找回",success:function(r){if(r.confirm){var i=a.currentTarget.dataset.orderid,n=wx.getStorageSync("kejia_farm_uid"),d=t.siteInfo.uniacid;t.util.request({url:"entry/wxapp/group",data:{op:"deleteOrder",uniacid:d,uid:n,orderid:i},success:function(t){console.log(t),1==t.data.code?(wx.showToast({title:t.data.msg}),e.getOrderData()):wx.showToast({title:t.data.msg})}})}}})}}); 
